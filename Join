# SQL query for the top 10 countries for Rockbuster in customer numbers

SELECT D.country,
 COUNT(customer_id) AS customer_count
FROM customer A 
INNER JOIN address B ON A.address_id = B.address_id
INNER JOIN city C ON B.city_id = C.city_id
INNER JOIN country D ON C.country_id = D.country_id
GROUP BY country
ORDER BY customer_count DESC 
LIMIT 10 

# SQL query for the top 10 cities in customer numbers within the top 10 countries


SELECT C.city,
       D.country,
 COUNT(customer_id) AS customer_count
FROM customer A
INNER JOIN address B ON A.address_id = B. address_id
INNER JOIN city C ON B.city_id = C.city_id
INNER JOIN country D ON C.country_id = D.country_id
WHERE country IN ('India','China','United States','Japan','Mexico','Brazil','Russian Federation','Philippines','Turkey','Indonesia')
GROUP BY country, city
ORDER BY customer_count DESC
LIMIT 10
